{"app_id":"tag","config":"{\"version\":\"\",\"release\":\"\",\"logger\":{\"max_len\":991,\"enable_debug\":true,\"enable_trace\":false},\"bfc_client\":{\"base_uri\":\"https://api.vadc-test.bastille.cloud\",\"api_key\":\"--redacted--\",\"max_items\":9999},\"tagger\":{\"path\":\"test/data/labbins.ndjson\"},\"tag\":{\"tag_prefix\":\"emp\",\"tag_refresh_period\":900000000000,\"dry_run\":false,\"concurrency\":9},\"webhook\":{\"interval\":3000000000,\"buffer_size\":999,\"buffer_types\":[\"observations\"]},\"http_server\":{\"host\":\"\",\"port\":3031,\"timeout\":10000000000}}","level":"info","msg":"loaded","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.880703Z"}
{"app_id":"tag","level":"info","msg":"starting up","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.881101Z"}
{"app_id":"tag","level":"info","msg":"worker starting","name":"webhook service","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.881321Z","worker_id":"X43f8xw"}
{"app_id":"tag","level":"info","msg":"refreshing tagger","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.881349Z"}
{"app_id":"tag","level":"info","msg":"starting http service","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.881991Z"}
{"app_id":"tag","level":"info","msg":"worker starting","name":"tag refresh","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.882042Z","worker_id":"JKIACR5"}
{"address":":3031","app_id":"tag","level":"info","msg":"listening","run_id":"QYN0wdE","ts":"2025-11-13T20:08:27.882029Z"}
{"app_id":"tag","body":"","headers":"{\"Accept\":[\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\"],\"Accept-Encoding\":[\"gzip, deflate, br, zstd\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Cookie\":[\"oauth_state=gT889rLk4mO1KmaLM1sqI04Kn_BJnDha75KBLX6EUD4\"],\"Sec-Ch-Ua\":[\"\\\"Google Chrome\\\";v=\\\"135\\\", \\\"Not-A.Brand\\\";v=\\\"8\\\", \\\"Chromium\\\";v=\\\"135\\\"\"],\"Sec-Ch-Ua-Mobile\":[\"?0\"],\"Sec-Ch-Ua-Platform\":[\"\\\"macOS\\\"\"],\"Sec-Fetch-Dest\":[\"document\"],\"Sec-Fetch-Mode\":[\"navigate\"],\"Sec-Fetch-Site\":[\"none\"],\"Sec-Fetch-User\":[\"?1\"],\"Upgrade-Insecure-Requests\":[\"1\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36\"]}","level":"debug","method":"GET","msg":"received request","path":"/docs","query":"{}","remote_ip":"[","remote_port":"","request_id":"kFBzB3V","run_id":"QYN0wdE","ts":"2025-11-13T20:09:06.003228Z"}
{"app_id":"tag","body":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n  \u003cmeta charset=\"utf-8\"\u003e\n  \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\u003e\n  \u003ctitle\u003eBastille Tag Integration API\u003c/title\u003e\n  \u003cscript src=\"/elements.min.js\"\u003e\u003c/script\u003e\n  \u003clink rel=\"stylesheet\" href=\"/elements.min.css\"\u003e\n  \u003cstyle\u003e\n    body { margin: 0; padding: 0; }\n  \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n  \u003celements-api\n    apiDescriptionUrl=\"/openapi.yaml\"\n    router=\"hash\"\n    layout=\"sidebar\"\n    hide-internal=\"true\"\n    hide-try-it=\"false\"\u003e\n  \u003c/elements-api\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n","elapsed":44209,"headers":"{\"Content-Type\":[\"text/html\"]}","level":"debug","msg":"sending response","request_id":"kFBzB3V","run_id":"QYN0wdE","status":200,"ts":"2025-11-13T20:09:06.003613Z"}
{"app_id":"tag","body":"","headers":"{\"Accept\":[\"*/*\"],\"Accept-Encoding\":[\"gzip, deflate, br, zstd\"],\"Accept-Language\":[\"en-US,en;q=0.9\"],\"Connection\":[\"keep-alive\"],\"Cookie\":[\"oauth_state=gT889rLk4mO1KmaLM1sqI04Kn_BJnDha75KBLX6EUD4\"],\"Referer\":[\"http://localhost:3031/docs\"],\"Sec-Ch-Ua\":[\"\\\"Google Chrome\\\";v=\\\"135\\\", \\\"Not-A.Brand\\\";v=\\\"8\\\", \\\"Chromium\\\";v=\\\"135\\\"\"],\"Sec-Ch-Ua-Mobile\":[\"?0\"],\"Sec-Ch-Ua-Platform\":[\"\\\"macOS\\\"\"],\"Sec-Fetch-Dest\":[\"empty\"],\"Sec-Fetch-Mode\":[\"cors\"],\"Sec-Fetch-Site\":[\"same-origin\"],\"User-Agent\":[\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36\"]}","level":"debug","method":"GET","msg":"received request","path":"/openapi.yaml","query":"{}","remote_ip":"[","remote_port":"","request_id":"F9qoSi3","run_id":"QYN0wdE","ts":"2025-11-13T20:09:06.122089Z"}
{"app_id":"tag","body":"openapi: 3.0.3\ninfo:\n  title: Bastille Tag Integration API\n  version: 0.0.1\n  description: |\n    Tag integration manages device tags in Fusion Center based on external data sources.\n\n    The service receives webhook events from Fusion Center containing device observations,\n    enriches them with tags from a configurable tagger (MDM/CMDB data), and updates devices\n    via the Fusion API. Tags are managed with a configurable prefix (e.g., \"emp:\") to separate\n    managed tags from user-defined tags.\n\n    ## Features\n    - Automatic tag synchronization via webhook events\n    - Manual tag refresh capability\n    - Dry-run mode for testing without updates\n    - Health monitoring and dynamic log level control\n  contact:\n    name: Bastille Integration Team\n  license:\n    name: Proprietary\n\nservers:\n  - url: http://localhost:3031\n    description: Local development server\n  - url: https://tag.bastille.cloud\n    description: Production server\n\ntags:\n  - name: tags\n    description: De--truncated--","elapsed":130667,"headers":"{\"Access-Control-Allow-Origin\":[\"*\"],\"Content-Type\":[\"application/x-yaml\"]}","level":"debug","msg":"sending response","request_id":"F9qoSi3","run_id":"QYN0wdE","status":200,"ts":"2025-11-13T20:09:06.122356Z"}
{"app_id":"tag","level":"info","msg":"refreshing tagger","run_id":"QYN0wdE","ts":"2025-11-13T20:23:27.879433Z","worker_id":"JKIACR5"}
{"app_id":"tag","level":"info","msg":"shutting down","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.730697Z"}
{"app_id":"tag","level":"info","msg":"shutting down http service","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.730863Z"}
{"app_id":"tag","level":"info","msg":"worker shutting down","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.730862Z","worker_id":"X43f8xw"}
{"app_id":"tag","level":"info","msg":"worker stopped","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.730914Z","worker_id":"X43f8xw"}
{"app_id":"tag","level":"info","msg":"worker stopped","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.7309Z","worker_id":"JKIACR5"}
{"app_id":"tag","level":"info","msg":"http service stopped","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.731053Z"}
{"app_id":"tag","level":"info","msg":"stopped","run_id":"QYN0wdE","ts":"2025-11-13T20:37:20.731066Z"}
